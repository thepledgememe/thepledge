<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Pledge</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <!-- for CSV parsing -->
    <style>
        body {
            background-color: #f4f4f9;
            font-family: 'Courier New', Courier, monospace;
            color: #333;
            margin: 0;
            padding: 0;
        }

        h1 {
            text-align: center;
            color: #003366;
            font-size: 3em;
            margin-top: 50px;
        }

        p,
        ul,
        ol,
        h2,
        h3 {
            max-width: 800px;
            margin: 20px auto;
            padding: 0 20px;
        }

        ol {
            background-color: #fff;
            padding: 15px;
            list-style: none;
            font-size: 1.2em;
        }

        ol li {
            padding: 10px 0;
        }

        ol li:before {
            content: "•";
            color: #003366;
            font-size: 1.5em;
            padding-right: 10px;
        }

        h2 {
            color: #003366;
            border-bottom: 2px solid #003366;
            padding-bottom: 5px;
            font-size: 2em;
        }

        h3 {
            color: #333;
            font-size: 1.5em;
        }

        h4 {
            color: #333;
            font-size: 1.5em;
            text-align: center;
        }


        ul {
            list-style-type: square;
            font-size: 1.2em;
            padding-left: 40px;
        }

        a {
            color: #006699;
            text-decoration: none;
            font-weight: bold;
        }

        a:hover {
            text-decoration: underline;
        }

        footer {
            text-align: center;
            padding: 50px;
            font-size: 0.9em;
        }

        /* Retro box styling */
        .box {
            background-color: #fff;
            border: 2px solid #003366;
            padding: 20px;
            max-width: 800px;
            margin: 20px auto;
            font-size: 1em;
            box-shadow: 5px 5px 0px #003366;
        }

        /* Add some spacing between paragraphs */
        p {
            line-height: 1.6;
        }

        /* Styling for header text */
        .header {
            background-color: #003366;
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 1.5em;
        }

        /* Table Styling */
        table {
            width: 90%;
            max-width: 800px;
            margin: 20px auto;
            border-collapse: collapse;
            font-family: 'Courier New', Courier, monospace;
            background-color: #fff;
            border: 2px solid #C0D8ED;
        }

        th,
        td {
            padding: 12px;
            border: 1px solid #C0D8ED;
            text-align: left;
            font-size: 1em;
        }

        th {
            background-color: #F5F5F5;
            color: #003366;
            font-size: 1.2em;
        }

        /* tr:nth-child(even) {
            background-color: #f4f4f9;
        }

        tr:nth-child(odd) {
            background-color: #fff;
        } */

        caption {
            caption-side: top;
            text-align: center;
            font-size: 1.5em;
            color: #003366;
            margin: 10px 0;
        }
    </style>
</head>

<body>
    <header class="header" style="display: flex; justify-content: space-between; align-items: center; padding: 10px; color: white;">
        <nav>
            <ul style="list-style: none; padding: 0; margin: 0; display: flex; gap: 15px;">
                <li><a href="index.html" style="color: white; text-decoration: none;">Home</a></li>
                <li><a href="dashboard.html" style="color: white; text-decoration: none;">Dashboard</a></li>
            </ul>
        </nav>
        <p style="margin: 0;">Contract address: coming soon</p>
    </header>
    
    <h2>Token Allocation at Launch</h2>
    <canvas id="tokenAllocationChart" width="400" height="400" style="margin: 0 auto; display: block;"></canvas>
    <script>

        // Register the datalabels plugin
        Chart.register(ChartDataLabels);

        const ctx = document.getElementById('tokenAllocationChart').getContext('2d');

        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['Pledged Tokens', 'Liquidity Pool', 'Available to Sell'],
                datasets: [{
                    data: [89, 10, 1],
                    backgroundColor: ['#003366', '#cce0ff', '#ffed99'],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                layout: {
                    padding: {
                        top: 70,
                        bottom: 70,
                        left: 20,
                        right: 20
                    }
                },
                plugins: {
                    legend: {
                        display: false // Disable default legend
                    },
                    tooltip: {
                        enabled: false // Disable default tooltip
                    },
                    datalabels: {
                        color: (context) => {
                            const label = context.chart.data.labels[context.dataIndex];
                            return label === 'Pledged Tokens' ? '#fff' : '#003366'; // White for Pledged Tokens, Dark Blue for others
                        },
                        font: {
                            weight: 'bold'
                        },
                        formatter: (value, context) => {
                            const label = context.chart.data.labels[context.dataIndex];
                            if (label === 'Pledged Tokens') {
                                return `89% Pledged Tokens 🤝`;
                            } else if (label === 'Liquidity Pool') {
                                return `10% Liquidity Pool`;
                            } else {
                                return `1% Available to Sell`;
                            }
                        },
                        anchor: (context) => {
                            const label = context.chart.data.labels[context.dataIndex];
                            return label === 'Available to Sell' ? 'center' : 'end';
                        },
                        align: (context) => {
                            const label = context.chart.data.labels[context.dataIndex];
                            return label === 'Liquidity Pool' ? 'end' : 'end';
                        },
                        offset: (context) => {
                            const label = context.chart.data.labels[context.dataIndex];
                            if (label === 'Pledged Tokens') return 20;
                            if (label === 'Liquidity Pool') return 40;
                            
                            return 60; // Available to Sell
                        },
                        backgroundColor: (context) => {
                            const index = context.dataIndex;
                            return context.chart.data.datasets[0].backgroundColor[index];
                        },
                        padding: {
                            top: 8,
                            bottom: 8,
                            left: 15,
                            right: 15
                        },
                        borderRadius: 15,
                        borderWidth: 1,
                        borderColor: 'rgba(0, 0, 0, 0.2)', // Simulates a subtle shadow effect

                    }
                }
            }
        });
    </script>




    <h2>Pledgers</h2>

    <h3>Who has taken the pledge?</h3>
    <p>Over 300 people have taken the pledge so far. The first 200 pledgers are listed below.</p>

    <table id="dataTable">
        <thead>
            <tr id="headerRow"></tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>
    <script>
        async function fetchData() {
            const response = await fetch('pledgers.csv'); // Adjust the path if needed
            const csvText = await response.text();

            Papa.parse(csvText, {
                header: true,
                complete: function (results) {
                    renderTable(results.data);
                }
            });
        }

        function renderTable(data) {
            const tableHeader = document.getElementById('headerRow');
            const tableBody = document.getElementById('tableBody');

            // Define the desired column order based on the CSV headers
            const columnOrder = ["Name", "Twitter", "Wallet", "Pledged Tokens"];

            // Clear any existing header or body content
            tableHeader.innerHTML = '';
            tableBody.innerHTML = '';

            // Set headers in the specified order
            columnOrder.forEach(key => {
                const th = document.createElement('th');
                th.textContent = key;
                tableHeader.appendChild(th);
            });

            // Fill rows
            data.forEach(row => {
                const tr = document.createElement('tr');
                columnOrder.forEach(key => {
                    const td = document.createElement('td');
                    let cell = row[key];

                    if (key.toLowerCase() === 'twitter') {
                        // Create a link for the Twitter column
                        const link = document.createElement('a');
                        link.href = `https://www.x.com/${cell}`;
                        link.textContent = `@${cell}`;
                        link.target = '_blank';
                        td.appendChild(link);
                    } else if (key.toLowerCase() === 'pledged tokens') {
                        // Directly parse the number without replacement
                        const numberValue = Number(cell);
                        td.textContent = !isNaN(numberValue) ? numberValue.toLocaleString() : cell || 'N/A';
                    } else {
                        // Display cell content or 'N/A' if undefined
                        td.textContent = cell || 'N/A';
                    }

                    tr.appendChild(td);
                });
                tableBody.appendChild(tr);
            });
        }




        fetchData();
    </script>

    <footer>
        <p>Find the pledge on Twitter for official announcements at <a href="https://twitter.com/thepledgememe"
                target="_blank">@ThePledgeMeme</a></p>
    </footer>

</body>

</html>